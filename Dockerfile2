FROM nvcr.io/nvidia/cuda:11.7.1-cudnn8-runtime-ubuntu22.04

RUN apt-get update && apt-get install -y \
    python3-pip \
    libopenmpi-dev \
    g++ \
    swig \
    libosmesa6-dev \
    patchelf \
    ffmpeg \
    wget

RUN wget https://mujoco.org/download/mujoco210-linux-x86_64.tar.gz -P ~/Downloads/
RUN mkdir -p ~/.mujoco/ && tar -zxf ~/Downloads/mujoco210-linux-x86_64.tar.gz -C ~/.mujoco/
RUN echo -e "\n# MuJoCo\nMUJOCO_PATH=~/.mujoco/mujoco210/bin\nexport LD_LIBRARY_PATH=\$MUJOCO_PATH:\$LD_LIBRARY_PATH" >> ~/.bashrc

COPY requirements.txt /nevo/requirements.txt
RUN virtualenv venv && source venv/bin/activate && pip install -r /nevo/requirements.txt
RUN AutoROM --accept-license --install-dir venv/lib/python3.10/site-packages/ale_py/roms/
